From 0942e22dabcfeb71c4d2546b90df267275890cb6 Mon Sep 17 00:00:00 2001
From: Brock Noland <brock@apache.org>
Date: Thu, 26 Dec 2013 19:44:45 +0000
Subject: [PATCH 217/218] HIVE-5524 - Unwanted delay in getting Hive metastore connection with METASTORE_CLIENT_CONNECT_RETRY_DELAY (Rajesh Balamohan via Brock Noland)

git-svn-id: https://svn.apache.org/repos/asf/hive/trunk@1553563 13f79535-47bb-0310-9956-ffa450edef68
---
 .../hadoop/hive/metastore/HiveMetaStoreClient.java |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/src/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java b/src/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
index 8035ae2..3a01d31 100644
--- a/src/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
+++ b/src/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
@@ -311,7 +311,7 @@ public class HiveMetaStoreClient implements IMetaStoreClient {
         }
       }
       // Wait before launching the next round of connection retries.
-      if (retryDelaySeconds > 0) {
+      if (!isConnected && retryDelaySeconds > 0) {
         try {
           LOG.info("Waiting " + retryDelaySeconds + " seconds before next connection attempt.");
           Thread.sleep(retryDelaySeconds * 1000);
-- 
1.7.0.4

