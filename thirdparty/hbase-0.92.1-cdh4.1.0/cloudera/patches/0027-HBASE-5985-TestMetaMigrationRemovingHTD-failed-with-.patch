From b6f2e23f26eeadddd3c54cefe0e60541e3bec265 Mon Sep 17 00:00:00 2001
From: Jimmy Xiang <jxiang@cloudera.com>
Date: Thu, 10 May 2012 11:42:25 -0700
Subject: [PATCH 027/151] HBASE-5985 TestMetaMigrationRemovingHTD failed with HADOOP 2.0.0

Reason: Bug
Author: Jimmy Xiang
Ref: CDH-5732
---
 .../hbase/client/TestMetaMigrationRemovingHTD.java |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/src/test/java/org/apache/hadoop/hbase/client/TestMetaMigrationRemovingHTD.java b/src/test/java/org/apache/hadoop/hbase/client/TestMetaMigrationRemovingHTD.java
index 453cdb0..4ba183b 100644
--- a/src/test/java/org/apache/hadoop/hbase/client/TestMetaMigrationRemovingHTD.java
+++ b/src/test/java/org/apache/hadoop/hbase/client/TestMetaMigrationRemovingHTD.java
@@ -79,6 +79,11 @@ public class TestMetaMigrationRemovingHTD {
     FileSystem fs = FileSystem.get(conf);
     // find where hbase will root itself, so we can copy filesystem there
     Path hbaseRootDir = TEST_UTIL.getDefaultRootDirPath();
+    if (!fs.isDirectory(hbaseRootDir.getParent())) {
+      // mkdir at first
+      doFsCommand(shell,
+        new String [] {"-mkdir", hbaseRootDir.getParent().toString()});
+    }
     doFsCommand(shell,
       new String [] {"-put", untar.toURI().toString(), hbaseRootDir.toString()});
     // See whats in minihdfs.
-- 
1.7.0.4

