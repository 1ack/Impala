From 219df3a8b08346757dca88027e3cc2e8718cb7e5 Mon Sep 17 00:00:00 2001
From: Gregory Chanan <gchanan@cloudera.com>
Date: Thu, 26 Jul 2012 17:57:03 -0700
Subject: [PATCH 084/151] HBASE-5603 rolling-restart.sh script hangs when attempting to detect expiration of /hbase/master znode

Reason: Backport
Author: Jonathan Hsieh
Ref: CDH-6929
---
 bin/rolling-restart.sh |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/bin/rolling-restart.sh b/bin/rolling-restart.sh
index 8c3cc2b..ec4edb5 100755
--- a/bin/rolling-restart.sh
+++ b/bin/rolling-restart.sh
@@ -97,7 +97,7 @@ else
     if [ "$zmaster" == "null" ]; then zmaster="master"; fi
     zmaster=$zparent/$zmaster
     echo -n "Waiting for Master ZNode ${zmaster} to expire"
-    while bin/hbase zkcli stat $zmaster >/dev/null 2>&1; do
+    while ! bin/hbase zkcli stat $zmaster 2>&1 | grep "Node does not exist"; do
       echo -n "."
       sleep 1
     done
-- 
1.7.0.4

