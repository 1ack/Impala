From 80fb4a8d1a391676ea145ba0d5efe6a6e88e0a04 Mon Sep 17 00:00:00 2001
From: Matteo Bertozzi <matteo.bertozzi@cloudera.com>
Date: Wed, 16 Jan 2013 09:29:45 -0800
Subject: [PATCH 158/196] HBASE-7560 TestCompactionState failures

Reason: Test failure
Author: Matteo Bertozzi
Ref: CDH-9858
---
 .../hbase/regionserver/TestCompactionState.java    |    5 +----
 1 files changed, 1 insertions(+), 4 deletions(-)

diff --git a/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompactionState.java b/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompactionState.java
index 79594d7..f1f32fd 100644
--- a/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompactionState.java
+++ b/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompactionState.java
@@ -167,14 +167,11 @@ public class TestCompactionState {
           assertEquals(CompactionState.NONE, state);
         }
       } else {
-        curt = System.currentTimeMillis();
-        waitTime = 20000;
-        endt = curt + waitTime;
+        // Wait until the compaction is done
         state = admin.getCompactionState(table);
         while (state != CompactionState.NONE && curt < endt) {
           Thread.sleep(10);
           state = admin.getCompactionState(table);
-          curt = System.currentTimeMillis();
         }
         // Now, compaction should be done.
         assertEquals(CompactionState.NONE, state);
-- 
1.7.0.4

