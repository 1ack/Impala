From d98f2590576dc5b928df38adedb604a9486f4d53 Mon Sep 17 00:00:00 2001
From: Ramkrishna S. Vasudevan <ramkrishna@apache.org>
Date: Wed, 10 Oct 2012 17:52:09 +0000
Subject: [PATCH 001/196] HBASE-6853 IllegalArgument Exception is thrown when an empty region is spliitted(Ram) : Addendum for testcase failure

git-svn-id: https://svn.apache.org/repos/asf/hbase/branches/0.94@1396708 13f79535-47bb-0310-9956-ffa450edef68
---
 .../TestSplitTransactionOnCluster.java             |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransactionOnCluster.java b/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransactionOnCluster.java
index 070e6d4..fc12422 100644
--- a/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransactionOnCluster.java
+++ b/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransactionOnCluster.java
@@ -643,7 +643,7 @@ public class TestSplitTransactionOnCluster {
     }
   }
   
-  @Test
+  @Test(timeout = 15000)
   public void testShouldThrowIOExceptionIfStoreFileSizeIsEmptyAndSHouldSuccessfullyExecuteRollback()
       throws Exception {
     final byte[] tableName = Bytes
@@ -654,6 +654,9 @@ public class TestSplitTransactionOnCluster {
       HTableDescriptor htd = new HTableDescriptor(tableName);
       htd.addFamily(new HColumnDescriptor("cf"));
       admin.createTable(htd);
+      while (!(cluster.getRegions(tableName).size() == 1)) {
+        Thread.sleep(100);
+      }
       List<HRegion> regions = cluster.getRegions(tableName);
       HRegionInfo hri = getAndCheckSingleTableRegion(regions);
       int tableRegionIndex = ensureTableRegionNotOnSameServerAsMeta(admin, hri);
-- 
1.7.0.4

