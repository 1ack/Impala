From aad4b00e13a8b5afdfda69e98863951409370c11 Mon Sep 17 00:00:00 2001
From: Matteo Bertozzi <matteo.bertozzi@cloudera.com>
Date: Wed, 2 Jan 2013 13:34:08 -0800
Subject: [PATCH 120/196] HBASE-7453 HBASE-7423 snapshot followup

Reason: Snapshots
Author: Matteo Bertozzi
Ref: CDH-9551
---
 .../hbase/snapshot/RestoreSnapshotHelper.java      |    2 +-
 .../hadoop/hbase/util/ModifyRegionUtils.java       |   12 ++++++------
 2 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java b/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java
index 4e60c1b..d0155e4 100644
--- a/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java
+++ b/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java
@@ -165,7 +165,7 @@ public class RestoreSnapshotHelper {
 
       // Remove regions from the current table
       monitor.rethrowException();
-      ModifyRegionUtils.deleteRegions(fs, catalogTracker, regionsToRemove);
+      ModifyRegionUtils.deleteRegions(conf, fs, catalogTracker, regionsToRemove);
     }
 
     // Regions to Add: present in the snapshot but not in the current table
diff --git a/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java b/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java
index 924084b..33a88eb 100644
--- a/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java
+++ b/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java
@@ -184,11 +184,11 @@ public abstract class ModifyRegionUtils {
    * @param catalogTracker the catalog tracker
    * @param regions list of {@link HRegionInfo} to delete.
    */
-  public static void deleteRegions(final FileSystem fs, final CatalogTracker catalogTracker,
-      final List<HRegionInfo> regions) throws IOException {
+  public static void deleteRegions(final Configuration conf, final FileSystem fs,
+      final CatalogTracker catalogTracker, final List<HRegionInfo> regions) throws IOException {
     if (regions != null && regions.size() > 0) {
       for (HRegionInfo hri: regions) {
-        deleteRegion(fs, catalogTracker, hri);
+        deleteRegion(conf, fs, catalogTracker, hri);
       }
     }
   }
@@ -201,12 +201,12 @@ public abstract class ModifyRegionUtils {
    * @param catalogTracker the catalog tracker
    * @param regionInfo {@link HRegionInfo} to delete.
    */
-  public static void deleteRegion(final FileSystem fs, final CatalogTracker catalogTracker,
-      final HRegionInfo regionInfo) throws IOException {
+  public static void deleteRegion(final Configuration conf, final FileSystem fs,
+      final CatalogTracker catalogTracker, final HRegionInfo regionInfo) throws IOException {
     // Remove region from .META.
     MetaEditor.deleteRegion(catalogTracker, regionInfo);
 
     // "Delete" region from FS
-    HFileArchiver.archiveRegion(fs, regionInfo);
+    HFileArchiver.archiveRegion(conf, fs, regionInfo);
   }
 }
-- 
1.7.0.4

