From e49405df6159122cfda2d8234963fe5b65c765e0 Mon Sep 17 00:00:00 2001
From: Jimmy Xiang <jxiang@apache.org>
Date: Wed, 23 Jan 2013 16:22:58 +0000
Subject: [PATCH 176/196] HBASE-7648 TestAcidGuarantees.testMixedAtomicity hangs sometimes

Reason: Test
Author: Jimmy Xiang
Ref: CDH-10002

git-svn-id: https://svn.apache.org/repos/asf/hbase/branches/0.94@1437539 13f79535-47bb-0310-9956-ffa450edef68
---
 .../apache/hadoop/hbase/TestAcidGuarantees.java    |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/src/test/java/org/apache/hadoop/hbase/TestAcidGuarantees.java b/src/test/java/org/apache/hadoop/hbase/TestAcidGuarantees.java
index 4923731..041bb87 100644
--- a/src/test/java/org/apache/hadoop/hbase/TestAcidGuarantees.java
+++ b/src/test/java/org/apache/hadoop/hbase/TestAcidGuarantees.java
@@ -36,6 +36,7 @@ import org.apache.hadoop.hbase.client.Put;
 import org.apache.hadoop.hbase.client.Result;
 import org.apache.hadoop.hbase.client.ResultScanner;
 import org.apache.hadoop.hbase.client.Scan;
+import org.apache.hadoop.hbase.regionserver.ConstantSizeRegionSplitPolicy;
 import org.apache.hadoop.hbase.util.Bytes;
 import org.apache.hadoop.util.Tool;
 import org.apache.hadoop.util.ToolRunner;
@@ -82,6 +83,9 @@ public class TestAcidGuarantees implements Tool {
     // Set small flush size for minicluster so we exercise reseeking scanners
     Configuration conf = HBaseConfiguration.create();
     conf.set(HConstants.HREGION_MEMSTORE_FLUSH_SIZE, String.valueOf(128*1024));
+    // prevent aggressive region split
+    conf.set(HConstants.HBASE_REGION_SPLIT_POLICY_KEY,
+      ConstantSizeRegionSplitPolicy.class.getName());
     util = new HBaseTestingUtility(conf);
   }
   
-- 
1.7.0.4

