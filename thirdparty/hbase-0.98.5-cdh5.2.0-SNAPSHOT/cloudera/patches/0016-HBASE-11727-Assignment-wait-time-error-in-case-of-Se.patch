From 1d84b98aff8282684e1c399e84b509fed92b17db Mon Sep 17 00:00:00 2001
From: Jimmy Xiang <jxiang@cloudera.com>
Date: Tue, 12 Aug 2014 12:57:27 -0700
Subject: [PATCH 16/31] HBASE-11727 Assignment wait time error in case of ServerNotRunningYetException

Reason: Bug
Author: Jimmy Xiang
Ref: CDH-20774
---
 .../hadoop/hbase/master/AssignmentManager.java     |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
index e275df0..5e3c4c8 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
@@ -2020,8 +2020,9 @@ public class AssignmentManager extends ZooKeeperListener {
                   + this.server.getConfiguration().getLong(ALREADY_IN_TRANSITION_WAITTIME,
                     DEFAULT_ALREADY_IN_TRANSITION_WAITTIME);
               } else {
-                maxWaitTime = this.server.getConfiguration().
-                  getLong("hbase.regionserver.rpc.startup.waittime", 60000);
+                maxWaitTime = EnvironmentEdgeManager.currentTimeMillis()
+                  + this.server.getConfiguration().getLong(
+                    "hbase.regionserver.rpc.startup.waittime", 60000);
               }
             }
             try {
-- 
1.7.0.4

