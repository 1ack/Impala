From 2f660b15ca58b69ad3f19bfd2a466632606535d8 Mon Sep 17 00:00:00 2001
From: Andrew Bayer <andrew@cloudera.com>
Date: Mon, 12 Dec 2011 12:37:55 -0800
Subject: [PATCH 01/58] CLOUDERA-BUILD. CDHifying Hive 0.8.0 RC3.

---
 build-common.xml                                   |   29 +++
 build.properties                                   |   10 +-
 build.xml                                          |   28 +++
 cli/ivy.xml                                        |    4 +-
 cloudera-pom.xml                                   |  185 ++++++++++++++++++++
 cloudera/maven-packaging/hive-anttasks/pom.xml     |  103 +++++++++++
 cloudera/maven-packaging/hive-builtins/pom.xml     |   92 ++++++++++
 cloudera/maven-packaging/hive-cli/pom.xml          |  147 ++++++++++++++++
 cloudera/maven-packaging/hive-common/pom.xml       |  119 +++++++++++++
 cloudera/maven-packaging/hive-contrib/pom.xml      |  127 ++++++++++++++
 cloudera/maven-packaging/hive-exec/pom.xml         |  167 ++++++++++++++++++
 .../maven-packaging/hive-hbase-handler/pom.xml     |  131 ++++++++++++++
 cloudera/maven-packaging/hive-hwi/pom.xml          |  119 +++++++++++++
 cloudera/maven-packaging/hive-jdbc/pom.xml         |  119 +++++++++++++
 cloudera/maven-packaging/hive-metastore/pom.xml    |  183 +++++++++++++++++++
 cloudera/maven-packaging/hive-pdk/pom.xml          |   92 ++++++++++
 cloudera/maven-packaging/hive-serde/pom.xml        |  139 +++++++++++++++
 cloudera/maven-packaging/hive-service/pom.xml      |  123 +++++++++++++
 cloudera/maven-packaging/hive-shims/pom.xml        |  111 ++++++++++++
 cloudera/maven-packaging/pom.xml                   |   99 +++++++++++
 .../maven-packaging/templates/cdh.build.template   |   11 ++
 .../maven-packaging/templates/libraries.template   |   38 ++++
 common/ivy.xml                                     |    9 +-
 contrib/ivy.xml                                    |    6 +-
 hbase-handler/ivy.xml                              |    6 +-
 hwi/ivy.xml                                        |    6 +-
 ivy/ivysettings.xml                                |   15 ++
 metastore/ivy.xml                                  |    6 +-
 ql/ivy.xml                                         |    6 +-
 serde/ivy.xml                                      |    6 +-
 shims/ivy.xml                                      |    9 +-
 31 files changed, 2212 insertions(+), 33 deletions(-)
 create mode 100644 cloudera-pom.xml
 create mode 100644 cloudera/maven-packaging/hive-anttasks/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-builtins/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-cli/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-common/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-contrib/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-exec/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-hbase-handler/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-hwi/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-jdbc/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-metastore/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-pdk/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-serde/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-service/pom.xml
 create mode 100644 cloudera/maven-packaging/hive-shims/pom.xml
 create mode 100644 cloudera/maven-packaging/pom.xml
 create mode 100644 cloudera/maven-packaging/templates/cdh.build.template
 create mode 100644 cloudera/maven-packaging/templates/libraries.template

diff --git a/src/build-common.xml b/src/build-common.xml
index a746966..2a91d5a 100644
--- a/src/build-common.xml
+++ b/src/build-common.xml
@@ -23,6 +23,33 @@
          name="hivecommon" default="jar">
 
   <property name="hive.root" location="${basedir}/.."/>
+
+  <taskdef resource="net/sf/antcontrib/antcontrib.properties">
+    <classpath>
+      <pathelement location="${hive.root}/testlibs/ant-contrib-1.0b3.jar"/>
+    </classpath>
+  </taskdef>
+
+  <!-- Initializes ivy/libraries.properties and build.properties with CDH versions -->
+  <if>
+    <and>
+      <not>
+        <isset property="cdh.maven" />
+      </not>
+      <not>
+        <available file="${hive.root}/cdh.build.properties" />
+      </not>
+    </and>
+    <then>
+      <exec  executable="mvn" dir="${hive.root}" failonerror="true">
+        <arg value="-f" />
+        <arg value="cloudera-pom.xml" />
+        <arg value="process-resources"/>
+      </exec>
+    </then>
+  </if>
+
+  <property file="${hive.root}/cdh.build.properties"/>
   <property file="${hive.root}/build.properties"/>
   <property file="${user.home}/build.properties" />
   <property file="${basedir}/build.properties" />
@@ -130,6 +157,8 @@
   <target name="install-hadoopcore-internal" depends="ivy-retrieve-hadoop-source"
     unless="hadoopcore.${hadoop.version.ant-internal}.install.done">
     <echo message="Project: ${ant.project.name}"/>
+    <move tofile="${build.dir.hadoop}/hadoop-${hadoop.version.ant-internal}.tar.gz"
+          file="${build.dir.hadoop}/hadoop-dist-${hadoop.version.ant-internal}.tar.gz" />
     <untar src="${build.dir.hadoop}/hadoop-${hadoop.version.ant-internal}.tar.gz" dest="${build.dir.hadoop}" compression="gzip"/>
     <chmod file="${hadoop.root}/bin/hadoop" perm="+x"/>
     <touch file="${build.dir.hadoop}/hadoop-${hadoop.version.ant-internal}.installed"/>
diff --git a/src/build.properties b/src/build.properties
index 0f994b7..1c45472 100644
--- a/src/build.properties
+++ b/src/build.properties
@@ -1,6 +1,6 @@
 Name=Hive
 name=hive
-version=0.8.1
+version=0.8.1-cdh4a1-SNAPSHOT
 year=2011
 
 javac.debug=on
@@ -10,11 +10,9 @@ javac.deprecation=off
 javac.args=
 javac.args.warnings=
 
-hadoop-0.20.version=0.20.1
-hadoop-0.20S.version=0.20.3-CDH3-SNAPSHOT
-hadoop-0.23.version=0.23.0
-hadoop.version=${hadoop-0.20.version}
-hadoop.security.version=${hadoop-0.20S.version}
+hadoop.version=0.20.1
+hadoop.security.version=${hadoop.version}
+hadoop.security.version.prefix=0.20S
 hadoop.mirror=http://mirror.facebook.net/facebook/hive-deps
 hadoop.mirror2=http://archive.cloudera.com/hive-deps
 
diff --git a/src/build.xml b/src/build.xml
index 047d432..22d61b8 100644
--- a/src/build.xml
+++ b/src/build.xml
@@ -22,7 +22,35 @@
          xmlns:ivy="antlib:org.apache.ivy.ant"
          xmlns:artifact="urn:maven-artifact-ant" >
 
+
+  <!-- load ant-contrib tasks to get the "if" task. -->
+  <taskdef resource="net/sf/antcontrib/antcontrib.properties">
+    <classpath>
+      <pathelement location="${basedir}/testlibs/ant-contrib-1.0b3.jar"/>
+    </classpath>
+  </taskdef>
+
+  <!-- Initializes ivy/libraries.properties and build.properties with CDH versions -->
+  <if>
+    <and>
+      <not>
+        <isset property="cdh.maven" />
+      </not>
+      <not>
+        <available file="${basedir}/cdh.build.properties" />
+      </not>
+    </and>
+    <then>
+      <exec  executable="mvn" dir="${basedir}" failonerror="true">
+        <arg value="-f" />
+        <arg value="cloudera-pom.xml" />
+        <arg value="process-resources"/>
+      </exec>
+    </then>
+  </if>
+
   <property name="hive.root" location="${basedir}"/>
+  <property file="${hive.root}/cdh.build.properties"/>
   <property file="${hive.root}/build.properties"/>
   <property file="${user.home}/build.properties" />
   <property file="${basedir}/build.properties" />
diff --git a/src/cli/ivy.xml b/src/cli/ivy.xml
index e062a23..c40e1fa 100644
--- a/src/cli/ivy.xml
+++ b/src/cli/ivy.xml
@@ -28,8 +28,8 @@
   </configurations>
   <dependencies>
     <!-- Runtime Dependencies -->
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
+    <dependency org="org.apache.hadoop" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
     </dependency>
     <dependency org="commons-cli" name="commons-cli" rev="${commons-cli.version}"/>
     <dependency org="commons-lang" name="commons-lang" rev="${commons-lang.version}"/>
diff --git a/src/cloudera-pom.xml b/src/cloudera-pom.xml
new file mode 100644
index 0000000..3e94360
--- /dev/null
+++ b/src/cloudera-pom.xml
@@ -0,0 +1,185 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   contributor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+<project>
+    <modelVersion>4.0.0</modelVersion>
+
+    <parent>
+        <groupId>com.cloudera.cdh</groupId>
+        <artifactId>hive-root</artifactId>
+        <version>4.0-a1-SNAPSHOT</version>
+        <relativePath>cloudera/maven-packaging/pom.xml</relativePath>
+    </parent>
+
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-ant</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <packaging>pom</packaging>
+
+    <scm>
+        <connection>scm:git:git@git.sf.cloudera.com:hive.git</connection>
+        <url>git@git.sf.cloudera.com:hive.git</url>
+    </scm>
+
+    <description>Hive ant</description>
+    <name>Hive ant</name>
+
+    <licenses>
+        <license>
+            <name>The Apache Software License, Version 2.0</name>
+            <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>
+        </license>
+    </licenses>
+
+    <organization>
+        <name>Cloudera</name>
+        <url>http://www.cloudera.com</url>
+    </organization>
+
+      <profiles>
+    <!--To allow standalone project to fetch CDH artifacts -->
+    <!--Activate by default doing a negation of negation   -->
+    <!-- this trick allows CDH root to switch it off       -->
+    <profile>
+      <id>cdh.repos</id>
+      <activation>
+        <activeByDefault>false</activeByDefault>
+        <property>
+          <name>use.cdh.repos</name>
+          <value>!false</value>
+        </property>
+      </activation>
+      <repositories>
+        <repository>
+          <id>cdh.releases.repo</id>
+          <url>https://repository.cloudera.com/content/groups/cdh-releases-rcs</url>
+          <name>CDH Releases Repository</name>
+          <snapshots>
+            <enabled>false</enabled>
+          </snapshots>
+        </repository>
+        <repository>
+          <id>cdh.snapshots.repo</id>
+          <url>https://repository.cloudera.com/content/repositories/snapshots</url>
+          <name>CDH Snapshots Repository</name>
+          <snapshots>
+            <enabled>true</enabled>
+          </snapshots>
+        </repository>
+      </repositories>
+    </profile>
+    <!-- Similar logic to allow us to skip compilation/tests when run -->
+    <!-- via do-release-build or packaging scripts, since we're already -->
+    <!-- compiling via direct ant calls. -->
+    <profile>
+      <id>non.release.build</id>
+      <activation>
+        <activeByDefault>false</activeByDefault>
+        <property>
+          <name>not.cdh.release.build</name>
+          <value>!false</value>
+        </property>
+      </activation>
+      <build>
+        <plugins>
+          <plugin>
+            <groupId>org.apache.maven.plugins</groupId>
+            <artifactId>maven-antrun-plugin</artifactId>
+            <inherited>false</inherited>
+            <executions>
+              <execution>
+                <id>clean</id>
+                <configuration>
+                  <target>
+                    <exec executable="${ant.cmd}" dir="${basedir}" failonerror="true">
+                      <arg value="clean"/>
+                      <arg value="-Dcdh.maven=true"/>
+                      <arg value="-Dreactor.repo=file://${maven.repo.local}"/>
+                      <arg value="-Divy.cache.dir=${ivy.cache.dir}"/>
+                    </exec>
+                  </target>
+                </configuration>
+                <goals>
+                  <goal>run</goal>
+                </goals>
+                <phase>clean</phase>
+              </execution>
+              <execution>
+                <id>compile</id>
+                <configuration>
+                  <target>
+                    <exec executable="${ant.cmd}" dir="${basedir}" failonerror="true">
+                      <arg value="jar"/>
+                      <arg value="-Dcdh.maven=true"/>
+                      <arg value="-Dreactor.repo=file://${maven.repo.local}"/>
+                      <arg value="-Divy.cache.dir=${ivy.cache.dir}"/>
+                    </exec>
+                  </target>
+                </configuration>
+                <goals>
+                  <goal>run</goal>
+                </goals>
+                <phase>compile</phase>
+              </execution>
+              <execution>
+                <id>test</id>
+                <configuration>
+                  <target unless="${skipTests}">
+                    <exec executable="${ant.cmd}" dir="${basedir}" failonerror="true">
+                      <arg value="test"/>
+                      <arg value="-Dcdh.maven=true"/>
+                      <arg value="-Dreactor.repo=file://${maven.repo.local}"/>
+                      <arg value="-Divy.cache.dir=${ivy.cache.dir}"/>
+                    </exec>
+                  </target>
+                </configuration>
+                <goals>
+                  <goal>run</goal>
+                </goals>
+                <phase>test</phase>
+              </execution>
+            </executions>
+          </plugin>
+        </plugins>
+      </build>
+    </profile>
+  </profiles>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>com.cloudera.kitchen</groupId>
+        <artifactId>maven-deps-to-props-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>cdh.build.properties</id>
+            <configuration>
+              <templateFile>${basedir}/cloudera/maven-packaging/templates/cdh.build.template</templateFile>
+              <targetFile>${basedir}/cdh.build.properties</targetFile>
+            </configuration>
+            <goals>
+              <goal>generate</goal>
+            </goals>
+            <phase>process-resources</phase>
+          </execution>
+        </executions>
+      </plugin>
+
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-anttasks/pom.xml b/src/cloudera/maven-packaging/hive-anttasks/pom.xml
new file mode 100644
index 0000000..6c5026b
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-anttasks/pom.xml
@@ -0,0 +1,103 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   contributor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-anttasks</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive anttasks</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>commons-lang</groupId>
+      <artifactId>commons-lang</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.velocity</groupId>
+      <artifactId>velocity</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/anttasks/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../ant/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-builtins/pom.xml b/src/cloudera/maven-packaging/hive-builtins/pom.xml
new file mode 100644
index 0000000..25e1c59
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-builtins/pom.xml
@@ -0,0 +1,92 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   shimsutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-builtins</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive builtins</name>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/builtins/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../builtins/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-cli/pom.xml b/src/cloudera/maven-packaging/hive-cli/pom.xml
new file mode 100644
index 0000000..e033ad0
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-cli/pom.xml
@@ -0,0 +1,147 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   contributor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-cli</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive cli</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>commons-cli</groupId>
+      <artifactId>commons-cli</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-lang</groupId>
+      <artifactId>commons-lang</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>jline</groupId>
+      <artifactId>jline</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libthrift</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-metastore</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-exec</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-serde</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-service</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-shims</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.mockito</groupId>
+      <artifactId>mockito-all</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/cli/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../cli/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-common/pom.xml b/src/cloudera/maven-packaging/hive-common/pom.xml
new file mode 100644
index 0000000..8ada87d
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-common/pom.xml
@@ -0,0 +1,119 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   commonutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-common</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive common</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-shims</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-cli</groupId>
+      <artifactId>commons-cli</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-lang</groupId>
+      <artifactId>commons-lang</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>log4j</groupId>
+      <artifactId>log4j</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/common/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../common/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-contrib/pom.xml b/src/cloudera/maven-packaging/hive-contrib/pom.xml
new file mode 100644
index 0000000..9417834
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-contrib/pom.xml
@@ -0,0 +1,127 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   contributor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-contrib</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive contrib</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-metastore</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-exec</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-serde</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-shims</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-codec</groupId>
+      <artifactId>commons-codec</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/contrib/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../contrib/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-exec/pom.xml b/src/cloudera/maven-packaging/hive-exec/pom.xml
new file mode 100644
index 0000000..7c95c34
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-exec/pom.xml
@@ -0,0 +1,167 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   executor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-exec</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive exec</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-metastore</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-serde</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-shims</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.antlr</groupId>
+      <artifactId>antlr</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.antlr</groupId>
+      <artifactId>antlr-runtime</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-log4j12</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.zookeeper</groupId>
+      <artifactId>zookeeper</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>com.google.guava</groupId>
+      <artifactId>guava</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libthrift</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>log4j</groupId>
+      <artifactId>log4j</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.json</groupId>
+      <artifactId>json</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-collections</groupId>
+      <artifactId>commons-collections</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-lang</groupId>
+      <artifactId>commons-lang</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.derby</groupId>
+      <artifactId>derby</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/ql/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../ql/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-hbase-handler/pom.xml b/src/cloudera/maven-packaging/hive-hbase-handler/pom.xml
new file mode 100644
index 0000000..efd7487
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-hbase-handler/pom.xml
@@ -0,0 +1,131 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   serdeutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-hbase-handler</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive hbase-handler</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-metastore</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-exec</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-serde</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>log4j</groupId>
+      <artifactId>log4j</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hbase</groupId>
+      <artifactId>hbase</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.zookeeper</groupId>
+      <artifactId>zookeeper</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/hbase-handler/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../hbase-handler/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-hwi/pom.xml b/src/cloudera/maven-packaging/hive-hwi/pom.xml
new file mode 100644
index 0000000..077f3bd
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-hwi/pom.xml
@@ -0,0 +1,119 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   hwiutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-hwi</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive hwi</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-cli</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-exec</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-shims</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/hwi/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../hwi/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-jdbc/pom.xml b/src/cloudera/maven-packaging/hive-jdbc/pom.xml
new file mode 100644
index 0000000..bdf8a3a
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-jdbc/pom.xml
@@ -0,0 +1,119 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   jdbcutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-jdbc</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive jdbc</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-metastore</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-serde</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-service</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libthrift</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/jdbc/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../jdbc/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-metastore/pom.xml b/src/cloudera/maven-packaging/hive-metastore/pom.xml
new file mode 100644
index 0000000..ff7f15c
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-metastore/pom.xml
@@ -0,0 +1,183 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   metastoreutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-metastore</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive metastore</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-serde</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-shims</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.antlr</groupId>
+      <artifactId>antlr</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.antlr</groupId>
+      <artifactId>antlr-runtime</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-cli</groupId>
+      <artifactId>commons-cli</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-lang</groupId>
+      <artifactId>commons-lang</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-dbcp</groupId>
+      <artifactId>commons-dbcp</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-pool</groupId>
+      <artifactId>commons-pool</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.datanucleus</groupId>
+      <artifactId>datanucleus-connectionpool</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.datanucleus</groupId>
+      <artifactId>datanucleus-core</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.datanucleus</groupId>
+      <artifactId>datanucleus-enhancer</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.datanucleus</groupId>
+      <artifactId>datanucleus-rdbms</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>javax.jdo</groupId>
+      <artifactId>jdo2-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.derby</groupId>
+      <artifactId>derby</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-log4j12</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libthrift</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libfb303</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>asm</groupId>
+      <artifactId>asm</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/metastore/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../metastore/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-pdk/pom.xml b/src/cloudera/maven-packaging/hive-pdk/pom.xml
new file mode 100644
index 0000000..e06761d
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-pdk/pom.xml
@@ -0,0 +1,92 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   shimsutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-pdk</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive pdk</name>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/pdk/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../pdk/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-serde/pom.xml b/src/cloudera/maven-packaging/hive-serde/pom.xml
new file mode 100644
index 0000000..457b7e8
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-serde/pom.xml
@@ -0,0 +1,139 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   serdeutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-serde</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive serde</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-shims</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-log4j12</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.mockito</groupId>
+      <artifactId>mockito-all</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libthrift</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libfb303</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-lang</groupId>
+      <artifactId>commons-lang</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-codec</groupId>
+      <artifactId>commons-codec</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/serde/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../serde/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-service/pom.xml b/src/cloudera/maven-packaging/hive-service/pom.xml
new file mode 100644
index 0000000..5a49fd3
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-service/pom.xml
@@ -0,0 +1,123 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   serviceutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-service</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive service</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-metastore</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.hive</groupId>
+      <artifactId>hive-exec</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libthrift</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libfb303</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/service/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../service/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/hive-shims/pom.xml b/src/cloudera/maven-packaging/hive-shims/pom.xml
new file mode 100644
index 0000000..b968760
--- /dev/null
+++ b/src/cloudera/maven-packaging/hive-shims/pom.xml
@@ -0,0 +1,111 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   shimsutor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>hive-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../pom.xml</relativePath>
+  </parent>
+
+  <groupId>org.apache.hive</groupId>
+  <artifactId>hive-shims</artifactId>
+  <version>${cdh.hive.version}</version>
+  <packaging>pom</packaging>
+
+  <name>Hive shims</name>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.zookeeper</groupId>
+      <artifactId>zookeeper</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.thrift</groupId>
+      <artifactId>libthrift</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging-api</artifactId>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.codehaus.mojo</groupId>
+        <artifactId>build-helper-maven-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-jar</id>
+            <phase>package</phase>
+            <goals>
+              <goal>attach-artifact</goal>
+            </goals>
+            <configuration>
+              <artifacts>
+                <artifact>
+                  <file>${basedir}/../../../build/shims/${project.artifactId}-${project.version}.jar</file>
+                  <type>jar</type>
+                </artifact>
+                <artifact>
+                  <file>${basedir}/target/${project.artifactId}-${project.version}-sources.jar</file>
+                  <type>jar</type>
+                  <classifier>sources</classifier>
+                </artifact>
+              </artifacts>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-antrun-plugin</artifactId>
+        <executions>
+          <execution>
+            <id>add-source-jar</id>
+            <phase>generate-sources</phase>
+            <goals>
+              <goal>run</goal>
+            </goals>
+            <configuration>
+              <target>
+                <mkdir dir="${basedir}/target" />
+                <jar destfile="${basedir}/target/${project.artifactId}-${project.version}-sources.jar">
+                  <fileset dir="${basedir}/../../../shims/src">
+                    <include name="**/*" />
+                  </fileset>
+                </jar>
+              </target>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/pom.xml b/src/cloudera/maven-packaging/pom.xml
new file mode 100644
index 0000000..c5b9fb7
--- /dev/null
+++ b/src/cloudera/maven-packaging/pom.xml
@@ -0,0 +1,99 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   contributor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+<project>
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>cdh-root</artifactId>
+    <version>4.0-a1-SNAPSHOT</version>
+    <relativePath>../../../../../pom.xml</relativePath>
+  </parent>
+
+  <groupId>com.cloudera.cdh</groupId>
+  <artifactId>hive-root</artifactId>
+  <version>4.0-a1-SNAPSHOT</version>
+  <packaging>pom</packaging>
+
+  <name>CDH Hive root</name>
+
+  <properties>
+    <cdh.hive.version>0.8.0-cdh4a1-SNAPSHOT</cdh.hive.version>
+  </properties>
+
+  <repositories>
+    <repository>
+      <id>cdh.releases.repo</id>
+      <url>https://repository.cloudera.com/content/groups/cdh-releases-rcs</url>
+      <name>CDH Releases Repository</name>
+      <snapshots>
+        <enabled>false</enabled>
+      </snapshots>
+    </repository>
+    <repository>
+      <id>cdh.snapshots.repo</id>
+      <url>https://repository.cloudera.com/content/repositories/snapshots</url>
+      <name>CDH Snapshots Repository</name>
+      <snapshots>
+        <enabled>true</enabled>
+      </snapshots>
+    </repository>
+  </repositories>
+
+  <modules>
+    <module>../../cloudera-pom.xml</module>
+    <module>hive-anttasks</module>
+    <module>hive-builtins</module>
+    <module>hive-cli</module>
+    <module>hive-common</module>
+    <module>hive-contrib</module>
+    <module>hive-exec</module>
+    <module>hive-hwi</module>
+    <module>hive-jdbc</module>
+    <module>hive-metastore</module>
+    <module>hive-serde</module>
+    <module>hive-service</module>
+    <module>hive-shims</module>
+    <module>hive-hbase-handler</module>
+    <module>hive-pdk</module>
+  </modules>
+
+  <dependencyManagement>
+    <dependencies>
+      <dependency>
+        <groupId>org.apache.thrift</groupId>
+        <artifactId>libthrift</artifactId>
+        <version>0.5.0-cdh</version>
+      </dependency>
+    </dependencies>
+  </dependencyManagement>
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-jar-plugin</artifactId>
+        <configuration>
+          <archive>
+            <manifestFile>target/classes/META-INF/MANIFEST.MF</manifestFile>
+          </archive>
+        </configuration>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/cloudera/maven-packaging/templates/cdh.build.template b/src/cloudera/maven-packaging/templates/cdh.build.template
new file mode 100644
index 0000000..922549e
--- /dev/null
+++ b/src/cloudera/maven-packaging/templates/cdh.build.template
@@ -0,0 +1,11 @@
+# These are for our dependency on Hadoop.
+hadoop.dep.org=org.apache.hadoop
+hadoop.dep.name=hadoop-dist
+hadoop.dep.artifact=hadoop-dist
+hadoop.version=org.apache.hadoop:hadoop-main.version
+hadoop.security.version=org.apache.hadoop:hadoop-main.version
+reactor.repo=https://repository.cloudera.com/content/repositories/snapshots
+hbase.version=org.apache.hbase:hbase.version
+hbase-test.version=org.apache.hbase:hbase.version
+avro.version=org.apache.avro:avro.version
+zookeeper.version=org.apache.zookeeper:zookeeper.version
diff --git a/src/cloudera/maven-packaging/templates/libraries.template b/src/cloudera/maven-packaging/templates/libraries.template
new file mode 100644
index 0000000..76641ca
--- /dev/null
+++ b/src/cloudera/maven-packaging/templates/libraries.template
@@ -0,0 +1,38 @@
+#   Licensed under the Apache License, Version 2.0 (the "License");
+#   you may not use this file except in compliance with the License.
+#   You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#   Unless required by applicable law or agreed to in writing, software
+#   distributed under the License is distributed on an "AS IS" BASIS,
+#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#   See the License for the specific language governing permissions and
+#   limitations under the License.
+
+#This properties file lists the versions of the various artifacts used by pig and components.
+#It drives ivy and the generation of a maven POM
+
+#These are the versions of our dependencies (in alphabetical order)
+#??? apacheant.version=1.7.1
+apacheant.version=1.7.1
+ant-task.version=2.0.10
+antlr-runtime.version=org.antlr:antlr-runtime:version
+checkstyle.version=checkstyle:checkstyle.version
+commons-cli.version=commons-cli:commons-cli.version
+commons-codec.version=commons-codec:commons-codec.version
+commons-collections.version=commons-collections:commons-collections.version
+commons-lang.version=commons-lang:commons-lang.version
+commons-logging.version=commons-logging:commons-logging.version
+commons-logging-api.version=commons-logging:commons-logging-api.version
+
+jdom.version=org.jdom:jdom.version
+ivy.version=org.apache.ivy:ivy.version
+log4j.version=log4j:log4j.version
+
+slf4j-api.version=1.6.1
+slf4j-log4j12.version=1.6.1
+thrift.version=0.5.0
+thrift-fb303.version=0.5.0
+avro.version=org.apache.avro:avro.version
+
diff --git a/src/common/ivy.xml b/src/common/ivy.xml
index 61c6cb4..e77b7ce 100644
--- a/src/common/ivy.xml
+++ b/src/common/ivy.xml
@@ -26,10 +26,11 @@
   <configurations>
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>
-  <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency> 
+    <dependencies>
+        <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+          <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+        </dependency> 
+
     <dependency org="org.apache.hive" name="hive-shims" rev="${version}"
                 conf="runtime" transitive="false"/>
     <dependency org="commons-cli" name="commons-cli" rev="${commons-cli.version}"/>
diff --git a/src/contrib/ivy.xml b/src/contrib/ivy.xml
index 0c0ff90..a699970 100644
--- a/src/contrib/ivy.xml
+++ b/src/contrib/ivy.xml
@@ -26,9 +26,9 @@
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>  
   <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency>
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
     <dependency org="org.apache.hive" name="hive-common" rev="${version}"
                 conf="runtime" transitive="false"/>
     <dependency org="org.apache.hive" name="hive-metastore" rev="${version}"
diff --git a/src/hbase-handler/ivy.xml b/src/hbase-handler/ivy.xml
index 0a8ab23..bf24ba0 100644
--- a/src/hbase-handler/ivy.xml
+++ b/src/hbase-handler/ivy.xml
@@ -26,9 +26,9 @@
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>  
   <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency>
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
     <dependency org="org.apache.hive" name="hive-common" rev="${version}"
                 conf="runtime" transitive="false"/>
     <dependency org="org.apache.hive" name="hive-metastore" rev="${version}"
diff --git a/src/hwi/ivy.xml b/src/hwi/ivy.xml
index fd39778..8dc0334 100644
--- a/src/hwi/ivy.xml
+++ b/src/hwi/ivy.xml
@@ -26,9 +26,9 @@
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>  
   <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency>
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
     <dependency org="org.apache.hive" name="hive-common" rev="${version}"
                 conf="runtime" transitive="false"/>
     <dependency org="org.apache.hive" name="hive-cli" rev="${version}"
diff --git a/src/ivy/ivysettings.xml b/src/ivy/ivysettings.xml
index ec4eab3..924f96c 100644
--- a/src/ivy/ivysettings.xml
+++ b/src/ivy/ivysettings.xml
@@ -47,6 +47,15 @@
       <artifact pattern="${hadoop.mirror2}/hadoop/core/[artifact]-[revision]/[artifact]-[revision].[ext]" />
     </url>
 
+    <!-- CDH build repo, the pattern attribute handles SNAPSHOT artifacts -->
+    <ibiblio name="reactor-repo" root="${reactor.repo}"
+             m2compatible="true"
+             checkmodified="true"/>
+    <ibiblio name="cloudera-releases" m2compatible="true"
+             root="https://repository.cloudera.com/content/groups/cdh-releases-rcs" checkmodified="true"/>
+    <ibiblio name="cloudera-snapshots" m2compatible="true"
+             root="https://repository.cloudera.com/content/repositories/snapshots" checkmodified="true"/>
+
     <ibiblio name="maven2" root="${repo.maven.org}" pattern="${maven2.pattern.ext}" m2compatible="true"/>
     <ibiblio name="apache-snapshot" root="${snapshot.apache.org}" m2compatible="true"
              checkmodified="${ivy.checkmodified}" 
@@ -64,18 +73,24 @@
     <chain name="default" dual="true" returnFirst="true" 
            checkmodified="${ivy.checkmodified}" 
            changingPattern="${ivy.changingPattern}">
+      <resolver ref="reactor-repo"/>
       <resolver ref="apache-snapshot"/>
       <resolver ref="maven2"/>
       <resolver ref="datanucleus-repo"/>
       <resolver ref="hadoop-source"/>
       <resolver ref="hadoop-source2"/>
+      <resolver ref="cloudera-releases" />
+      <resolver ref="cloudera-snapshots" />
     </chain>
 
     <chain name="internal" dual="true">
+      <resolver ref="reactor-repo"/>
       <resolver ref="fs"/>
       <resolver ref="apache-snapshot"/>
       <resolver ref="maven2"/>
       <resolver ref="datanucleus-repo"/>
+      <resolver ref="cloudera-releases" />
+      <resolver ref="cloudera-snapshots" />
     </chain>
 
     <chain name="external">
diff --git a/src/metastore/ivy.xml b/src/metastore/ivy.xml
index ac62873..cbea8c8 100644
--- a/src/metastore/ivy.xml
+++ b/src/metastore/ivy.xml
@@ -26,9 +26,9 @@
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>
   <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency>
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
     <dependency org="org.apache.hive" name="hive-common" rev="${version}"
                 conf="runtime" transitive="false"/>
     <dependency org="org.apache.hive" name="hive-serde" rev="${version}"
diff --git a/src/ql/ivy.xml b/src/ql/ivy.xml
index 8a5f616..c9bb3d4 100644
--- a/src/ql/ivy.xml
+++ b/src/ql/ivy.xml
@@ -26,9 +26,9 @@
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>
   <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency>
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
     <dependency org="org.apache.hive" name="hive-common" rev="${version}"
                 conf="runtime" transitive="false"/>
     <dependency org="org.apache.hive" name="hive-metastore" rev="${version}"
diff --git a/src/serde/ivy.xml b/src/serde/ivy.xml
index c2c75b7..5dc2a27 100644
--- a/src/serde/ivy.xml
+++ b/src/serde/ivy.xml
@@ -26,9 +26,9 @@
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>
   <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency>
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
     <dependency org="org.apache.hive" name="hive-common" rev="${version}"
                 conf="runtime" transitive="false"/>
     <dependency org="org.apache.hive" name="hive-shims" rev="${version}"
diff --git a/src/shims/ivy.xml b/src/shims/ivy.xml
index e056b80..9474e0c 100644
--- a/src/shims/ivy.xml
+++ b/src/shims/ivy.xml
@@ -27,9 +27,12 @@
     <include file="${ivy.conf.dir}/common-configurations.xml"/>
   </configurations>
   <dependencies>
-    <dependency org="org.apache.hadoop" name="hadoop-core" rev="${hadoop.version.ant-internal}">
-      <artifact name="hadoop" type="source" ext="tar.gz"/>
-    </dependency>
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.version.ant-internal}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
+    <dependency org="${hadoop.dep.org}" name="${hadoop.dep.name}" rev="${hadoop.security.version}">
+      <artifact name="${hadoop.dep.artifact}" type="source" ext="tar.gz"/>
+    </dependency> 
     <dependency org="org.apache.zookeeper" name="zookeeper"
                 rev="${zookeeper.version}" transitive="false">
       <include type="jar"/>
-- 
1.7.0.4

