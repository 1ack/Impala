From 7fcb44e417f891d9266221eb5a0efb1b03136010 Mon Sep 17 00:00:00 2001
From: Michael Stack <stack@apache.org>
Date: Thu, 29 Mar 2012 15:30:29 +0000
Subject: [PATCH 29/36] HBASE-5669 AggregationClient fails validation for open stoprow scan

Reason: Bug
Author: Mubarak Seyed
Ref: CDH-5861
---
 .../client/coprocessor/AggregationClient.java      |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java b/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java
index 0d4a9e4..b90401e 100644
--- a/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java
+++ b/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java
@@ -112,7 +112,8 @@ public class AggregationClient {
     if (scan == null
         || (Bytes.equals(scan.getStartRow(), scan.getStopRow()) && !Bytes
             .equals(scan.getStartRow(), HConstants.EMPTY_START_ROW))
-        || Bytes.compareTo(scan.getStartRow(), scan.getStopRow()) > 0) {
+        || ((Bytes.compareTo(scan.getStartRow(), scan.getStopRow()) > 0) &&
+        	!Bytes.equals(scan.getStopRow(), HConstants.EMPTY_END_ROW))) {
       throw new IOException(
           "Agg client Exception: Startrow should be smaller than Stoprow");
     } else if (scan.getFamilyMap().size() != 1) {
-- 
1.7.0.4

