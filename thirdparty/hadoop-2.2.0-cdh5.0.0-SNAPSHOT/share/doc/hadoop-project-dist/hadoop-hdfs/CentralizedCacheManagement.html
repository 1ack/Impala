<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jan 7, 2014 -->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Hadoop Distributed File System-2.2.0-cdh5.0.0-SNAPSHOT - Centralized Cache Management in HDFS</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
        <meta name="Date-Revision-yyyymmdd" content="20140107" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      </head>
  <body class="composite">
    <div id="banner">
                  <a href="http://hadoop.apache.org/" id="bannerLeft">
                                        <img src="http://hadoop.apache.org/images/hadoop-logo.jpg" alt="" />
                </a>
                        <a href="http://www.apache.org/" id="bannerRight">
                                        <img src="http://www.apache.org/images/asf_logo_wide.png" alt="" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                                <div class="xleft">
                          <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
                      <a href="http://hadoop.apache.org/" class="externalLink">Hadoop</a>
                &gt;
                      <a href="../">Apache Hadoop Project Dist POM</a>
                &gt;
                Apache Hadoop 2.2.0-cdh5.0.0-SNAPSHOT
                </div>
            <div class="xright">            <a href="http://wiki.apache.org/hadoop" class="externalLink">Wiki</a>
            |
                <a href="https://svn.apache.org/repos/asf/hadoop/" class="externalLink">SVN</a>
            |
                <a href="http://hadoop.apache.org/" class="externalLink">Apache Hadoop</a>
              
                                &nbsp;| Last Published: 2014-01-07
              &nbsp;| Version: 2.2.0-cdh5.0.0-SNAPSHOT
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                                                <h5>General</h5>
                  <ul>
                  <li class="none">
                  <a href="../../index.html">Overview</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/SingleCluster.html">Single Node Setup</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/ClusterSetup.html">Cluster Setup</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/CommandsManual.html">Hadoop Commands Reference</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/FileSystemShell.html">File System Shell</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/Compatibility.html">Hadoop Compatibility</a>
            </li>
          </ul>
                       <h5>Common</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/CLIMiniCluster.html">CLI Mini Cluster</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/NativeLibraries.html">Native Libraries</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/Superusers.html">Superusers</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/ServiceLevelAuth.html">Service Level Authorization</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/HttpAuthentication.html">HTTP Authentication</a>
            </li>
          </ul>
                       <h5>HDFS</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/HdfsUserGuide.html">HDFS User Guide</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/HDFSHighAvailabilityWithQJM.html">High Availability With QJM</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/HDFSHighAvailabilityWithNFS.html">High Availability With NFS</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/Federation.html">Federation</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/HdfsSnapshots.html">HDFS Snapshots</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/HdfsDesign.html">HDFS Architecture</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/HdfsEditsViewer.html">Edits Viewer</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/HdfsImageViewer.html">Image Viewer</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/HdfsPermissionsGuide.html">Permissions and HDFS</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/HdfsQuotaAdminGuide.html">Quotas and HDFS</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/Hftp.html">HFTP</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/LibHdfs.html">C API libhdfs</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/WebHDFS.html">WebHDFS REST API</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-hdfs-httpfs/index.html">HttpFS Gateway</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/ShortCircuitLocalReads.html">Short Circuit Local Reads</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/CentralizedCacheManagement.html">Centralized Cache Management</a>
            </li>
          </ul>
                       <h5>MapReduce</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduce_Compatibility_Hadoop1_Hadoop2.html">Compatibilty between Hadoop 1.x and Hadoop 2.x</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/EncryptedShuffle.html">Encrypted Shuffle</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/PluggableShuffleAndPluggableSort.html">Pluggable Shuffle/Sort</a>
            </li>
          </ul>
                       <h5>YARN</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/YARN.html">YARN Architecture</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/WritingYarnApplications.html">Writing YARN Applications</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/CapacityScheduler.html">Capacity Scheduler</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/FairScheduler.html">Fair Scheduler</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/WebApplicationProxy.html">Web Application Proxy</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/YarnCommands.html">YARN Commands</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-sls/SchedulerLoadSimulator.html">Scheduler Load Simulator</a>
            </li>
          </ul>
                       <h5>YARN REST APIs</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/WebServicesIntro.html">Introduction</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/ResourceManagerRest.html">Resource Manager</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/NodeManagerRest.html">Node Manager</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/MapredAppMasterRest.html">MR Application Master</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/HistoryServerRest.html">History Server</a>
            </li>
          </ul>
                       <h5>Auth</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-auth/index.html">Overview</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-auth/Examples.html">Examples</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-auth/Configuration.html">Configuration</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-auth/BuildingIt.html">Building</a>
            </li>
          </ul>
                       <h5>Reference</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/releasenotes.html">Release Notes</a>
            </li>
                  <li class="none">
                  <a href="../../api/index.html">API docs</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/CHANGES.txt">Common CHANGES.txt</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/CHANGES.txt">HDFS CHANGES.txt</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-mapreduce/CHANGES.txt">MapReduce CHANGES.txt</a>
            </li>
          </ul>
                       <h5>Configuration</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/core-default.xml">core-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/hdfs-default.xml">hdfs-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml">mapred-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-common/yarn-default.xml">yarn-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/DeprecatedProperties.html">Deprecated Properties</a>
            </li>
          </ul>
                                 <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
          <img alt="Built by Maven" src="./images/logos/maven-feather.png"/>
        </a>
                       
                            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. See accompanying LICENSE file. --><div class="section"><h2>Centralized Cache Management in HDFS<a name="Centralized_Cache_Management_in_HDFS"></a></h2><p>[ <a href="./index.html">Go Back</a> ]</p><ul><li><a href="#Background">Background</a></li><li><a href="#Use_Cases">Use Cases</a></li><li><a href="#Architecture">Architecture</a></li><li><a href="#Interface">Interface</a><ul><li><a href="#hdfs_cacheadmin_Shell">hdfs cacheadmin Shell</a><ul><li><a href="#addDirective">addDirective</a></li><li><a href="#removeDirective">removeDirective</a></li><li><a href="#removeDirectives">removeDirectives</a></li><li><a href="#listDirectives">listDirectives</a></li><li><a href="#addPool">addPool</a></li><li><a href="#modifyPool">modifyPool</a></li><li><a href="#removePool">removePool</a></li><li><a href="#listPools">listPools</a></li><li><a href="#help">help</a></li></ul></li></ul></li><li><a href="#Configuration">Configuration</a><ul><li><a href="#Native_Libraries">Native Libraries</a></li><li><a href="#Configuration_Properties">Configuration Properties</a><ul><li><a href="#Required">Required</a></li><li><a href="#Optional">Optional</a></li></ul></li><li><a href="#OS_Limits">OS Limits</a></li></ul></li></ul><div class="section"><h3><a name="Background">Background</a></h3><p>Normally, HDFS relies on the operating system to cache data it reads from disk. However, HDFS can also be configured to use centralized cache management. Under centralized cache management, the HDFS NameNode itself decides which blocks should be cached, and where they should be cached.</p><p>Centralized cache management has several advantages. First of all, it prevents frequently used block files from being evicted from memory. This is particularly important when the size of the working set exceeds the size of main memory, which is true for many big data applications. Secondly, when HDFS decides what should be cached, it can let clients know about this information through the getFileBlockLocations API. Finally, when the DataNode knows a block is locked into memory, it can provide access to that block via mmap.</p></div><div class="section"><h3><a name="Use_Cases">Use Cases</a></h3><p>Centralized cache management is most useful for files which are accessed very often. For example, a &quot;fact table&quot; in Hive which is often used in joins is a good candidate for caching. On the other hand, when running a classic &quot;word count&quot; MapReduce job which counts the number of words in each document, there may not be any good candidates for caching, since all the files may be accessed exactly once.</p></div><div class="section"><h3><a name="Architecture">Architecture</a></h3><img src="images/caching.png" alt="Caching Architecture" /><p>With centralized cache management, the NameNode coordinates all caching across the cluster. It receives cache information from each DataNode via the cache report, a periodic message that describes all the blocks IDs cached on a given DataNode. The NameNode will reply to DataNode heartbeat messages with commands telling it which blocks to cache and which to uncache.</p><p>The NameNode stores a set of path cache directives, which tell it which files to cache. The NameNode also stores a set of cache pools, which are groups of cache directives. These directives and pools are persisted to the edit log and fsimage, and will be loaded if the cluster is restarted.</p><p>Periodically, the NameNode rescans the namespace, to see which blocks need to be cached based on the current set of path cache directives. Rescans are also triggered by relevant user actions, such as adding or removing a cache directive or removing a cache pool.</p><p>Cache directives also may specific a numeric cache replication, which is the number of replicas to cache. This number may be equal to or smaller than the file's block replication. If multiple cache directives cover the same file with different cache replication settings, then the highest cache replication setting is applied.</p><p>We do not currently cache blocks which are under construction, corrupt, or otherwise incomplete. If a cache directive covers a symlink, the symlink target is not cached.</p><p>Caching is currently done on a per-file basis, although we would like to add block-level granularity in the future.</p></div><div class="section"><h3><a name="Interface">Interface</a></h3><p>The NameNode stores a list of &quot;cache directives.&quot; These directives contain a path as well as the number of times blocks in that path should be replicated.</p><p>Paths can be either directories or files. If the path specifies a file, that file is cached. If the path specifies a directory, all the files in the directory will be cached. However, this process is not recursive-- only the direct children of the directory will be cached.</p><div class="section"><h4><a name="hdfs_cacheadmin_Shell">hdfs cacheadmin Shell</a></h4><p>Path cache directives can be created by the <tt>hdfs cacheadmin -addDirective</tt> command and removed via the <tt>hdfs cacheadmin -removeDirective</tt> command. To list the current path cache directives, use <tt>hdfs cacheadmin -listDirectives</tt>. Each path cache directive has a unique 64-bit ID number which will not be reused if it is deleted. To remove all path cache directives with a specified path, use <tt>hdfs cacheadmin -removeDirectives</tt>.</p><p>Directives are grouped into &quot;cache pools.&quot; Each cache pool gets a share of the cluster's resources. Additionally, cache pools are used for authentication. Cache pools have a mode, user, and group, similar to regular files. The same authentication rules are applied as for normal files. So, for example, if the mode is 0777, any user can add or remove directives from the cache pool. If the mode is 0644, only the owner can write to the cache pool, but anyone can read from it. And so forth.</p><p>Cache pools are identified by name. They can be created by the <tt>hdfs cacheAdmin -addPool</tt> command, modified by the <tt>hdfs cacheadmin -modifyPool</tt> command, and removed via the <tt>hdfs cacheadmin -removePool</tt> command. To list the current cache pools, use <tt>hdfs cacheAdmin -listPools</tt></p><div class="section"><h5><a name="addDirective">addDirective</a></h5><p>Usage: <tt>hdfs cacheadmin -addDirective -path &lt;path&gt; -replication &lt;replication&gt; -pool &lt;pool-name&gt; </tt></p><p>Add a new cache directive.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;path&gt;</td><td align="left">A path to cache. The path can be a directory or a file.</td></tr><tr class="b"><td align="left">&lt;replication&gt;</td><td align="left">The cache replication factor to use. Defaults to 1.</td></tr><tr class="a"><td align="left">&lt;pool-name&gt;</td><td align="left">The pool to which the directive will be added. You must have write permission on the cache pool in order to add new directives.</td></tr></table></div><div class="section"><h5><a name="removeDirective">removeDirective</a></h5><p>Usage: <tt>hdfs cacheadmin -removeDirective &lt;id&gt; </tt></p><p>Remove a cache directive.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;id&gt;</td><td align="left">The id of the cache directive to remove. You must have write permission on the pool of the directive in order to remove it. To see a list of cachedirective IDs, use the -listDirectives command.</td></tr></table></div><div class="section"><h5><a name="removeDirectives">removeDirectives</a></h5><p>Usage: <tt>hdfs cacheadmin -removeDirectives &lt;path&gt; </tt></p><p>Remove every cache directive with the specified path.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;path&gt;</td><td align="left">The path of the cache directives to remove. You must have write permission on the pool of the directive in order to remove it. To see a list of cache directives, use the -listDirectives command.</td></tr></table></div><div class="section"><h5><a name="listDirectives">listDirectives</a></h5><p>Usage: <tt>hdfs cacheadmin -listDirectives [-path &lt;path&gt;] [-pool &lt;pool&gt;] </tt></p><p>List cache directives.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;path&gt;</td><td align="left">List only cache directives with this path. Note that if there is a cache directive for <i>path</i> in a cache pool that we don't have read access for, it will not be listed.</td></tr><tr class="b"><td align="left">&lt;pool&gt;</td><td align="left">List only path cache directives in that pool.</td></tr></table></div><div class="section"><h5><a name="addPool">addPool</a></h5><p>Usage: <tt>hdfs cacheadmin -addPool &lt;name&gt; [-owner &lt;owner&gt;] [-group &lt;group&gt;] [-mode &lt;mode&gt;] [-weight &lt;weight&gt;] </tt></p><p>Add a new cache pool.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;name&gt;</td><td align="left">Name of the new pool.</td></tr><tr class="b"><td align="left">&lt;owner&gt;</td><td align="left">Username of the owner of the pool. Defaults to the current user.</td></tr><tr class="a"><td align="left">&lt;group&gt;</td><td align="left">Group of the pool. Defaults to the primary group name of the current user.</td></tr><tr class="b"><td align="left">&lt;mode&gt;</td><td align="left">UNIX-style permissions for the pool. Permissions are specified in octal, e.g. 0755. By default, this is set to 0755.</td></tr><tr class="a"><td align="left">&lt;weight&gt;</td><td align="left">Weight of the pool. This is a relative measure of the importance of the pool used during cache resource management. By default, it is set to 100.</td></tr></table></div><div class="section"><h5><a name="modifyPool">modifyPool</a></h5><p>Usage: <tt>hdfs cacheadmin -modifyPool &lt;name&gt; [-owner &lt;owner&gt;] [-group &lt;group&gt;] [-mode &lt;mode&gt;] [-weight &lt;weight&gt;] </tt></p><p>Modifies the metadata of an existing cache pool.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;name&gt;</td><td align="left">Name of the pool to modify.</td></tr><tr class="b"><td align="left">&lt;owner&gt;</td><td align="left">Username of the owner of the pool.</td></tr><tr class="a"><td align="left">&lt;group&gt;</td><td align="left">Groupname of the group of the pool.</td></tr><tr class="b"><td align="left">&lt;mode&gt;</td><td align="left">Unix-style permissions of the pool in octal.</td></tr><tr class="a"><td align="left">&lt;weight&gt;</td><td align="left">Weight of the pool.</td></tr></table></div><div class="section"><h5><a name="removePool">removePool</a></h5><p>Usage: <tt>hdfs cacheadmin -removePool &lt;name&gt; </tt></p><p>Remove a cache pool. This also uncaches paths associated with the pool.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;name&gt;</td><td align="left">Name of the cache pool to remove.</td></tr></table></div><div class="section"><h5><a name="listPools">listPools</a></h5><p>Usage: <tt>hdfs cacheadmin -listPools [name] </tt></p><p>Display information about one or more cache pools, e.g. name, owner, group, permissions, etc.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;name&gt;</td><td align="left">If specified, list only the named cache pool.</td></tr></table></div><div class="section"><h5><a name="help">help</a></h5><p>Usage: <tt>hdfs cacheadmin -help &lt;command-name&gt; </tt></p><p>Get detailed help about a command.</p><table border="0" class="bodyTable"><tr class="a"><td align="left">&lt;command-name&gt;</td><td align="left">The command for which to get detailed help. If no command is specified, print detailed help for all commands.</td></tr></table></div></div></div><div class="section"><h3><a name="Configuration">Configuration</a></h3><div class="section"><h4><a name="Native_Libraries">Native Libraries</a></h4><p>In order to lock block files into memory, the DataNode relies on native JNI code found in <tt>libhadoop.so</tt>. Be sure to <a href="../hadoop-common/NativeLibraries.html">enable JNI</a> if you are using HDFS centralized cache management.</p></div><div class="section"><h4><a name="Configuration_Properties">Configuration Properties</a></h4><div class="section"><h5>Required<a name="Required"></a></h5><p>Be sure to configure the following:</p><ul><li>dfs.datanode.max.locked.memory<p>The DataNode will treat this as the maximum amount of memory it can use for its cache. When setting this value, please remember that you will need space in memory for other things, such as the Java virtual machine (JVM) itself and the operating system's page cache.</p></li></ul></div><div class="section"><h5>Optional<a name="Optional"></a></h5><p>The following properties are not required, but may be specified for tuning:</p><ul><li>dfs.namenode.path.based.cache.refresh.interval.ms<p>The NameNode will use this as the amount of milliseconds between subsequent path cache rescans. This calculates the blocks to cache and each DataNode containing a replica of the block that should cache it.</p><p>By default, this parameter is set to 300000, which is five minutes.</p></li><li>dfs.datanode.fsdatasetcache.max.threads.per.volume<p>The DataNode will use this as the maximum number of threads per volume to use for caching new data.</p><p>By default, this parameter is set to 4.</p></li><li>dfs.cachereport.intervalMsec<p>The DataNode will use this as the amount of milliseconds between sending a full report of its cache state to the NameNode.</p><p>By default, this parameter is set to 10000, which is 10 seconds.</p></li><li>dfs.namenode.path.based.cache.block.map.allocation.percent<p>The percentage of the Java heap which we will allocate to the cached blocks map. The cached blocks map is a hash map which uses chained hashing. Smaller maps may be accessed more slowly if the number of cached blocks is large; larger maps will consume more memory. The default is 0.25 percent.</p></li></ul></div></div><div class="section"><h4><a name="OS_Limits">OS Limits</a></h4><p>If you get the error &quot;Cannot start datanode because the configured max locked memory size... is more than the datanode's available RLIMIT_MEMLOCK ulimit,&quot; that means that the operating system is imposing a lower limit on the amount of memory that you can lock than what you have configured. To fix this, you must adjust the ulimit -l value that the DataNode runs with. Usually, this value is configured in <tt>/etc/security/limits.conf</tt>. However, it will vary depending on what operating system and distribution you are using.</p><p>You will know that you have correctly configured this value when you can run <tt>ulimit -l</tt> from the shell and get back either a higher value than what you have configured with <tt>dfs.datanode.max.locked.memory</tt>, or the string &quot;unlimited,&quot; indicating that there is no limit. Note that it's typical for <tt>ulimit -l</tt> to output the memory lock limit in KB, but dfs.datanode.max.locked.memory must be specified in bytes.</p></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;            2014
              Apache Software Foundation
            
                       - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
