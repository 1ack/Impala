From 9b9abde24e5adb47f4ae0ff2fa6000d7f1a85332 Mon Sep 17 00:00:00 2001
From: Carl Steinbach <carl@cloudera.com>
Date: Sun, 19 Aug 2012 20:55:48 -0700
Subject: [PATCH 128/144] CLOUDERA-BUILD. Fix eclipse classpath template

Reason: Bug
Author: Carl Steinbach
Ref: CDH-7401
---
 build.xml                    |    1 +
 eclipse-templates/.classpath |   72 ++++++++++++++++++++---------------------
 ivy/libraries.properties     |    1 +
 shims/ivy.xml                |   16 +++++++++
 4 files changed, 53 insertions(+), 37 deletions(-)

diff --git a/src/build.xml b/src/build.xml
index 464a545..f689f2a 100644
--- a/src/build.xml
+++ b/src/build.xml
@@ -625,6 +625,7 @@
       </fileset>
       <filterset>
         <filtersfile file="${hive.root}/ivy/libraries.properties"/>
+        <filtersfile file="${hive.root}/cdh.build.properties"/>
         <filter token="PROJECT" value="${eclipse.project}"/>
         <filter token="HADOOPVER" value="${hadoop.version.ant-internal}"/>
         <filter token="HADOOPVERPREF" value="${hadoop.version.ant-internal.prefix}"/>
diff --git a/src/eclipse-templates/.classpath b/src/eclipse-templates/.classpath
index ce9de61..f04767f 100644
--- a/src/eclipse-templates/.classpath
+++ b/src/eclipse-templates/.classpath
@@ -18,41 +18,37 @@
 --> 
 <classpath>
   <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/ant-1.6.5.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/commons-cli-1.2.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/commons-codec-1.3.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/commons-el-1.0.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/commons-httpclient-3.0.1.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/commons-logging-1.1.1.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/commons-net-1.4.1.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/core-3.1.1.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/ftplet-api-1.0.0.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/ftpserver-core-1.0.0.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/ftpserver-deprecated-1.0.0-M2.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/hadoop-core-@HADOOPVER@.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/hadoop-test-@HADOOPVER@.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/hadoop-tools-@HADOOPVER@.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/hsqldb-1.8.0.10.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/jasper-compiler-5.5.12.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/jasper-runtime-5.5.12.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/jets3t-0.7.1.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/jetty-6.1.14.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/jetty-util-6.1.14.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/jsp-2.1-6.1.14.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/jsp-api-2.1-6.1.14.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/junit-4.5.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/kfs-0.3.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/mina-core-2.0.0-M5.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/oro-2.0.8.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/servlet-api-2.5-6.1.14.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.20.shim/xmlenc-0.52.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/hadoop-archives-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/hadoop-auth-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/hadoop-common-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/hadoop-mapreduce-client-core-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-annotations-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-archives-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-auth-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-common-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-hdfs-@HADOOPVER@-tests.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-hdfs-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-mapreduce-client-common-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-mapreduce-client-core-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-mapreduce-client-jobclient-@HADOOPVER@-tests.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-mapreduce-client-jobclient-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-mapreduce-client-shuffle-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-yarn-api-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-yarn-common-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-yarn-server-common-@HADOOPVER@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/hadoop0.23.shim/hadoop-yarn-server-nodemanager-@HADOOPVER@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/avro-@avro.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/avro-mapred-@avro.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/jline-@jline.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/sqlline-@sqlline.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/json-@json.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/asm-@asm.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/commons-cli-@commons-cli.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/commons-codec-@commons-codec.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/commons-collections-@commons-collections.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/commons-compress-@commons-compress.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/commons-configuration-@commons-configuration.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/commons-dbcp-@commons-dbcp.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/commons-lang-@commons-lang.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/commons-logging-@commons-logging.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/commons-logging-api-@commons-logging-api.version@.jar"/>
@@ -60,6 +56,13 @@
   <classpathentry kind="lib" path="build/ivy/lib/default/guava-@guava.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/hbase-@hbase.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/hbase-@hbase.version@-tests.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-core-asl-@jackson.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-jaxrs-@jackson.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-mapper-asl-@jackson.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-xc-@jackson.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/jetty-@jetty.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/jetty-util-@jetty.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/servlet-api-@servlet-api.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/libfb303-@libfb303.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/libthrift-@libthrift.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/zookeeper-@zookeeper.version@.jar"/>
@@ -71,18 +74,11 @@
   <classpathentry kind="lib" path="build/ivy/lib/default/datanucleus-core-@datanucleus-core.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/datanucleus-enhancer-@datanucleus-enhancer.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/datanucleus-rdbms-@datanucleus-rdbms.version@.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/default/commons-cli-@commons-cli.version@.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/default/commons-collections-@commons-collections.version@.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/default/commons-dbcp-@commons-dbcp.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/datanucleus-connectionpool-@datanucleus-connectionpool.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/commons-pool-@commons-pool.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/slf4j-api-@slf4j-api.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/slf4j-log4j12-@slf4j-log4j12.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/JavaEWAH-@javaewah.version@.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-core-asl-1.8.8.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-jaxrs-1.8.8.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-mapper-asl-1.8.8.jar"/>
-  <classpathentry kind="lib" path="build/ivy/lib/default/jackson-xc-1.8.8.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/mockito-all-@mockito-all.version@.jar"/>
   <classpathentry kind="lib" path="build/builtins/hive-builtins-@HIVE_VERSION@.jar"/>
   <classpathentry kind="src" path="build/contrib/test/src"/>
@@ -90,6 +86,7 @@
   <classpathentry kind="src" path="build/ql/test/src"/>
   <classpathentry kind="src" path="build/ql/gen/antlr/gen-java"/>
   <classpathentry kind="src" path="cli/src/java"/>
+  <classpathentry kind="src" path="cli/src/test"/>
   <classpathentry kind="src" path="common/src/java"/>
   <classpathentry kind="src" path="common/src/test"/>
   <classpathentry kind="src" path="contrib/src/java"/>
@@ -110,8 +107,10 @@
   <classpathentry kind="src" path="service/src/test"/>
   <classpathentry kind="src" path="jdbc/src/java"/>
   <classpathentry kind="src" path="jdbc/src/test"/>
-  <classpathentry kind="src" path="shims/src/@HADOOPVERPREF@/java"/>
+  <classpathentry kind="src" path="shims/src/0.23/java"/>
   <classpathentry kind="src" path="shims/src/common/java"/>
+  <classpathentry kind="src" path="shims/src/common-secure/java"/>
+  <classpathentry kind="src" path="shims/src/test"/>
   <classpathentry kind="src" path="hwi/src/java"/>
   <classpathentry kind="src" path="hwi/src/test"/>
   <classpathentry kind="src" path="hbase-handler/src/java"/>
@@ -119,6 +118,5 @@
   <classpathentry kind="src" path="pdk/src/java"/>
   <classpathentry kind="src" path="pdk/test-plugin/src"/>
   <classpathentry kind="src" path="builtins/src"/>
-  <classpathentry kind="src" path="cli/src/test"/>
   <classpathentry kind="output" path="build/eclipse-classes"/>
 </classpath>
diff --git a/src/ivy/libraries.properties b/src/ivy/libraries.properties
index 2a3c355..36fd91b 100644
--- a/src/ivy/libraries.properties
+++ b/src/ivy/libraries.properties
@@ -58,6 +58,7 @@ libthrift.version=0.7.0
 log4j.version=1.2.16
 maven-ant-tasks.version=2.1.0
 mockito-all.version=1.8.2
+servlet-api.version=2.5-20081211
 rat.version=0.8
 slf4j-api.version=1.6.1
 slf4j-log4j12.version=1.6.1
diff --git a/src/shims/ivy.xml b/src/shims/ivy.xml
index 0983dec..8409645 100644
--- a/src/shims/ivy.xml
+++ b/src/shims/ivy.xml
@@ -73,6 +73,22 @@
       <exclude org="commons-daemon" module="commons-daemon"/><!--bad POM-->
       <exclude org="org.apache.commons" module="commons-daemon"/><!--bad POM-->
     </dependency>
+    <dependency org="org.apache.hadoop" name="hadoop-mapreduce-client-jobclient"	
+                rev="${hadoop-0.23.version}"	
+                conf="hadoop0.23.shim->default">	
+      <artifact name="hadoop-mapreduce-client-jobclient" ext="jar" />	
+      <artifact name="hadoop-mapreduce-client-jobclient" type="tests" ext="jar"
+                m:classifier="tests"/>
+      <exclude org="commons-daemon" module="commons-daemon"/><!--bad POM-->	
+      <exclude org="org.apache.commons" module="commons-daemon"/><!--bad POM-->	
+    </dependency>	
+    <dependency org="org.apache.hadoop" name="hadoop-mapreduce-client-common"	
+                rev="${hadoop-0.23.version}"	
+                conf="hadoop0.23.shim->default">	
+      <include type="jar"/>	
+      <exclude org="commons-daemon" module="commons-daemon"/><!--bad POM-->	
+      <exclude org="org.apache.commons" module="commons-daemon"/><!--bad POM-->	
+    </dependency>
 
     <!-- Hadoop 0.20 shim dependencies. Used for building 0.20 shims. -->
     <dependency org="org.apache.hadoop" name="hadoop-core"
-- 
1.7.0.4

