From 03677b0799289598b82264225fef66c9a455ac83 Mon Sep 17 00:00:00 2001
From: Zhenxiao Luo <zhenxiao@cloudera.com>
Date: Tue, 24 Jul 2012 17:10:52 -0700
Subject: [PATCH 119/148] CLOUDERA-BUILD. CDH-6964: Add junit exclude utility to disable testcases in cdh4-0.9.0

---
 build-common.xml |    2 +-
 build.properties |    2 ++
 common/build.xml |    2 +-
 3 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/build-common.xml b/src/build-common.xml
index 2869021..c734150 100644
--- a/src/build-common.xml
+++ b/src/build-common.xml
@@ -526,7 +526,7 @@
       <batchtest todir="${test.build.dir}" unless="testcase">
         <fileset dir="${test.build.classes}"
                  includes="**/${test.include}.class"
-                 excludes="**/TestSerDe.class,**/TestHiveMetaStore.class,**/*$*.class" />
+                 excludes="**/TestSerDe.class,**/TestHiveMetaStore.class,**/*$*.class,${test.junit.exclude}" />
       </batchtest>
       <batchtest todir="${test.build.dir}" if="testcase">
         <fileset dir="${test.build.classes}" includes="**/${testcase}.class"/>
diff --git a/src/build.properties b/src/build.properties
index b94d5f9..c337c96 100644
--- a/src/build.properties
+++ b/src/build.properties
@@ -73,6 +73,8 @@ jasperc.test.jar=${hadoop.root}/lib/jetty-ext/jasper-compiler.jar
 jsp.test.jar=${hadoop.root}/lib/jetty-ext/jsp-api.jar
 common.jar=${hadoop.root}/lib/commons-httpclient-3.0.1.jar
 
+test.junit.exclude=
+
 #
 # Ivy Properties
 #
diff --git a/src/common/build.xml b/src/common/build.xml
index 0d0665f..2712c03 100755
--- a/src/common/build.xml
+++ b/src/common/build.xml
@@ -58,7 +58,7 @@ to call at top-level: ant deploy-contrib compile-core-test
       <batchtest todir="${test.build.dir}" unless="testcase">
         <fileset dir="${test.build.classes}"
                  includes="**/${test.include}.class"
-                 excludes="**/*$*.class" />
+                 excludes="**/*$*.class,${test.junit.exclude}" />
       </batchtest>
       <batchtest todir="${test.build.dir}" if="testcase">
         <fileset dir="${test.build.classes}" includes="**/${testcase}.class"/>
-- 
1.7.0.4

